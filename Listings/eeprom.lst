C51 COMPILER V9.60.7.0   EEPROM                                                            11/06/2023 10:23:47 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE EEPROM
OBJECT MODULE PLACED IN .\Objects\eeprom.obj
COMPILER INVOKED BY: D:\Embedded_drive\Keil_v5\C51\BIN\C51.EXE src\lib\SRC\eeprom.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDI
                    -R(.\src\lib\INC) DEBUG OBJECTEXTEND PRINT(.\Listings\eeprom.lst) OBJECT(.\Objects\eeprom.obj)

line level    source

   1          /*
   2           * @Description: 
   3           * @Blog: saisaiwa.com
   4           * @Author: ccy
   5           * @Date: 2023-11-03 16:42:16
   6           * @LastEditTime: 2023-11-03 16:51:20
   7           */
   8          #include "eeprom.h"
   9          
  10          void iap_close() {
  11   1          IAP_CONTR = 0;
  12   1          IAP_CMD = 0;
  13   1          IAP_TRIG = 0;
  14   1          IAP_ADDRH = 0x80;
  15   1          IAP_ADDRL = 0;
  16   1      }
  17          
  18          u8 ee_read(u16 start_addr) {
  19   1          u8 dat;
  20   1          IAP_CONTR = 0x80;
  21   1          IAP_TPS = 22;  // 22.118Mhz
  22   1          IAP_CMD = 1;
  23   1          IAP_ADDRL = start_addr;
  24   1          IAP_ADDRH = start_addr >> 8;
  25   1          IAP_TRIG = 0x5a;
  26   1          IAP_TRIG = 0xa5;
  27   1          _nop_();
  28   1          dat = IAP_DATA;
  29   1          iap_close();
  30   1          return dat;
  31   1      }
  32          
  33          void ee_erase(u16 addr) {
  34   1          IAP_CONTR = 0x80;
  35   1          IAP_TPS = 22;  // 22.118Mhz
  36   1          IAP_CMD = 3;
  37   1          IAP_ADDRL = addr;
  38   1          IAP_ADDRH = addr >> 8;
  39   1          IAP_TRIG = 0x5a;
  40   1          IAP_TRIG = 0xa5;
  41   1          _nop_();
  42   1          iap_close();
  43   1      }
  44          
  45          void ee_write(u16 addr, u8 dat) {
  46   1          IAP_CONTR = 0x80;
  47   1          IAP_TPS = 22;  // 22.118Mhz
  48   1          IAP_CMD = 2;
  49   1          IAP_ADDRL = addr;
  50   1          IAP_ADDRH = addr >> 8;
  51   1          IAP_DATA = dat;
  52   1          IAP_TRIG = 0x5a;
  53   1          IAP_TRIG = 0xa5;
  54   1          _nop_();
C51 COMPILER V9.60.7.0   EEPROM                                                            11/06/2023 10:23:47 PAGE 2   

  55   1          iap_close();
  56   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     91    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
